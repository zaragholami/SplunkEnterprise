<form version="1.1" theme="dark">
  <label>Login Activities</label>
    <fieldset submitButton="false" autoRun="true">
    <input type="text" token="field1">
	<label>Host</label>
      <default>$clickedHOST$</default>
    </input>
    <input type="time" token="field2">
      <label>Time Frame</label>
      <default>
        <earliest>-24h@h</earliest>
        <latest>now</latest>
      </default>
    </input>
  </fieldset>
    <row>
    <panel>
      <title>Login Success by USER</title>
      <chart>
        <title>Is a user possibly logging in to several machines?</title>
        <search>
          <query>sourcetype="linux_secure" action=success | stats count by user</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
          <refresh>1m</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.sliceCollapsingThreshold">0</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>Login Failures by USER</title>
      <chart>
        <title>Is any host being targeted out of the normal?</title>
        <search>
          <query>sourcetype="linux_secure" action=failure | stats count by user</query>
          <earliest>-7d@h</earliest>
          <latest>now</latest>
          <refresh>30s</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.chart.sliceCollapsingThreshold">0</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
  <row>
    <panel>
      <title>CURRENT SSH Sessions</title>
      <table>
        <search>
          <query>sourcetype="linux_secure"  | transaction pid startswith="session opened" | eval TimeLoggedIn=tostring(now() - _time, "duration") | regex _raw!="session closed" | table _time TimeLoggedIn host user dvc | appendpipe  [stats count| eval error="No Active Sessions" | where count==0 |table error]</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="user">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="src_ip">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="host">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
  </row>
   <row>
    <panel>
      <title>Successful Logins by Host</title>
      <table>
        <search>
          <query>sourcetype="linux_secure" | transaction pid maxevents=3 endswith="session closed" | eval HHMMSS=tostring(duration, "duration") | table _time user dest dvc HHMMSS | sort - _time</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="refresh.display">progressbar</option>
        <format type="color" field="user">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="dest">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="src_ip">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
      </table>
    </panel>
    <panel>
      <title>Login Failures by Host</title>
      <table>
        <search>
          <query>sourcetype="linux_secure" action=failure | stats count by host, user, src | table host user src count | stats list(user) as user list(src) as from list(count) as count by host</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
        </search>
        <option name="drilldown">none</option>
        <option name="percentagesRow">false</option>
        <option name="refresh.display">progressbar</option>
        <option name="rowNumbers">false</option>
        <option name="totalsRow">false</option>
        <option name="wrap">false</option>
        <format type="color" field="user">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="from">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="color" field="host">
          <colorPalette type="sharedList"></colorPalette>
          <scale type="sharedCategory"></scale>
        </format>
        <format type="number" field="from"></format>
      </table>
    </panel>
  </row>
  <row>
    <panel>
      <title>Timechart of Failed Logins</title>
      <chart>
        <search>
          <query>sourcetype="linux_secure" action=failure | timechart count by host</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
          <refresh>30s</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
    <panel>
      <title>Timechart of Successful Logins</title>
      <chart>
        <search>
          <query>sourcetype="linux_secure" action=success | timechart count by host</query>
          <earliest>$field2.earliest$</earliest>
          <latest>$field2.latest$</latest>
          <refresh>30s</refresh>
          <refreshType>delay</refreshType>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.drilldown">none</option>
        <option name="refresh.display">progressbar</option>
      </chart>
    </panel>
  </row>
 </form>